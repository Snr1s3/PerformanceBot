name: Notify Me

on:
  push:
    branches:
      - main

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Telegram notification
        env:
          TELEGRAM_TOKEN: ${{ secrets.TELEGRAM_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
        run: |
          RESPONSE=$(curl -s -w "%{http_code}" -o response.txt -X POST https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage \
            -d chat_id=${TELEGRAM_CHAT_ID} \
            -d parse_mode=Markdown \
            -d text="üöÄ *New push to repository:* *${{ github.repository }}*%0A%0A*Branch:* \`${{ github.ref_name }}\`%0A*Commit:* [${{ github.sha }}](${{ github.server_url }}/${{ github.repository }}/commit/${{ github.sha }})%0A*By:* ${{ github.actor }}%0A%0A_See more:_ [${{ github.server_url }}/${{ github.repository }}](${{ github.server_url }}/${{ github.repository }})")
          if [ "$RESPONSE" = "200" ]; then
            echo "‚úÖ Telegram notification sent successfully."
          else
            echo "‚ùå Failed to send Telegram notification. HTTP status: $RESPONSE"
            cat response.txt
            exit 1
          fi
